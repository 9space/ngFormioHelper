!function e(r,o,s){function i(n,m){if(!o[n]){if(!r[n]){var u="function"==typeof require&&require;if(!m&&u)return u(n,!0);if(t)return t(n,!0);var a=new Error("Cannot find module '"+n+"'");throw a.code="MODULE_NOT_FOUND",a}var l=o[n]={exports:{}};r[n][0].call(l.exports,function(e){var o=r[n][1][e];return i(o?o:e)},l,l.exports,e,r,o,s)}return o[n].exports}for(var t="function"==typeof require&&require,n=0;n<s.length;n++)i(s[n]);return i}({1:[function(e,r,o){"use strict";angular.module("ngFormioHelper",["formio","ui.router"]).filter("capitalize",[function(){return _.capitalize}]).filter("truncate",[function(){return function(e,r){return _.isNumber(r)&&(r={length:r}),_.truncate(e,r)}}]).directive("fileread",[function(){return{scope:{fileread:"="},link:function(e,r){r.bind("change",function(r){var o=new FileReader;o.onloadend=function(r){e.$apply(function(){e.fileread=jQuery(r.target.result)})},o.readAsText(r.target.files[0])})}}}]).provider("FormioResource",["$stateProvider",function(e){var r={};return{register:function(o,s,i){r[o]=i.title||o;var t=i&&i.parent?i.parent:null,n=o+"Id",m=function(e){var r={};return r[n]=e._id,r},u=function(e){return["$scope","$rootScope","$state","$stateParams","Formio","FormioUtils","$controller",e]},a=i&&i.templates?i.templates:{},l=i&&i.controllers?i.controllers:{},c=i.query?i.query:"";e.state(o+"Index",{url:"/"+o+c,parent:t?t:null,params:i.params&&i.params.index,templateUrl:a.index?a.index:"formio-helper/resource/index.html",controller:u(function(e,r,i,t,u,a,c){e.currentResource={name:o,queryId:n,formUrl:s},e.$on("submissionView",function(e,r){i.go(o+".view",m(r))}),e.$on("submissionEdit",function(e,r){i.go(o+".edit",m(r))}),e.$on("submissionDelete",function(e,r){i.go(o+".delete",m(r))}),l.index&&c(l.index,{$scope:e})})}).state(o+"Create",{url:"/create/"+o+c,parent:t?t:null,params:i.params&&i.params.create,templateUrl:a.create?a.create:"formio-helper/resource/create.html",controller:u(function(e,r,t,u,a,c,f){e.currentResource={name:o,queryId:n,formUrl:s},e.submission=i.defaultValue?i.defaultValue:{data:{}};var p=!1;if(l.create){var d=f(l.create,{$scope:e});p=d.handle||!1}p||e.$on("formSubmission",function(e,r){t.go(o+".view",m(r))})})}).state(o,{"abstract":!0,url:"/"+o+"/:"+n,parent:t?t:null,templateUrl:a["abstract"]?a["abstract"]:"formio-helper/resource/resource.html",controller:u(function(e,r,i,m,u,a,c){var f=s+"/submission/"+m[n];e.currentResource=e[o]={name:o,queryId:n,formUrl:s,submissionUrl:f,formio:new u(f),resource:{},form:{},href:"/#/"+o+"/"+m[n]+"/",parent:t?e[t]:{href:"/#/",name:"home"}},e.currentResource.loadFormPromise=e.currentResource.formio.loadForm().then(function(r){return e.currentResource.form=e[o].form=r,r}),e.currentResource.loadSubmissionPromise=e.currentResource.formio.loadSubmission().then(function(r){return e.currentResource.resource=e[o].submission=r,r}),l["abstract"]&&c(l["abstract"],{$scope:e})})}).state(o+".view",{url:"/",parent:o,params:i.params&&i.params.view,templateUrl:a.view?a.view:"formio-helper/resource/view.html",controller:u(function(e,r,o,s,i,t,n){l.view&&n(l.view,{$scope:e})})}).state(o+".edit",{url:"/edit",parent:o,params:i.params&&i.params.edit,templateUrl:a.edit?a.edit:"formio-helper/resource/edit.html",controller:u(function(e,r,s,i,t,n,u){var a=!1;if(l.edit){var c=u(l.edit,{$scope:e});a=c.handle||!1}a||e.$on("formSubmission",function(e,r){s.go(o+".view",m(r))})})}).state(o+".delete",{url:"/delete",parent:o,params:i.params&&i.params["delete"],templateUrl:a["delete"]?a["delete"]:"formio-helper/resource/delete.html",controller:u(function(e,r,s,i,n,m,u){var a=!1;if(e.resourceName=o,l["delete"]){var c=u(l["delete"],{$scope:e});a=c.handle||!1}a||e.$on("delete",function(){t&&"home"!==t?s.go(t+".view"):s.go("home",null,{reload:!0})})})})},$get:function(){return r}}}]).directive("formioForms",function(){return{restrict:"E",replace:!0,scope:{src:"=",base:"=",tag:"=?"},templateUrl:"formio-helper/form/list.html",controller:["$scope","Formio",function(e,r){e.forms=[];var o={type:"form"};e.tag&&(o.tags=e.tag),new r(e.src).loadForms({params:o}).then(function(r){e.forms=r})}]}}).provider("FormioForms",["$stateProvider",function(e){var r={};return{register:function(r,o,s){var i=s&&s.templates?s.templates:{},t=s&&s.controllers?s.controllers:{},n=r?r+".":"";e.state(n+"formIndex",{url:"/forms",params:s.params&&s.params.index,templateUrl:i.index?i.index:"formio-helper/form/index.html",controller:["$scope","Formio","$controller",function(e,r,i){e.formBase=n,e.formsSrc=o+"/form",e.formsTag=s.tag,t.index&&i(t.index,{$scope:e})}]}).state(n+"form",{url:"/form/:formId","abstract":!0,templateUrl:i.form?i.form:"formio-helper/form/form.html",controller:["$scope","$stateParams","Formio","$controller",function(e,s,i,m){var u=o+"/form/"+s.formId;e.formBase=n,e.currentForm={name:r,url:u,form:{}},e.currentForm.formio=new i(u),e.currentForm.promise=e.currentForm.formio.loadForm().then(function(r){return e.currentForm.form=r,r}),t.form&&m(t.form,{$scope:e})}]}).state(n+"form.view",{url:"/",params:s.params&&s.params.view,templateUrl:i.view?i.view:"formio-helper/form/view.html",controller:["$scope","$state","FormioUtils","$controller",function(e,r,o,i){e.submission={data:{}},s.field&&e.currentForm.promise.then(function(){e.currentResource.loadSubmissionPromise.then(function(r){e.submission.data[s.field]=r,o.hideFields(e.currentForm.form,[s.field])})}),e.$on("formSubmission",function(){r.go(n+"form.submissions")}),t.view&&i(t.view,{$scope:e})}]}).state(n+"form.submissions",{url:"/submissions",params:s.params&&s.params.submissions,templateUrl:i.submissions?i.submissions:"formio-helper/submission/index.html",controller:["$scope","$state","$stateParams","FormioUtils","$controller",function(e,o,i,m,u){e.submissionQuery={},e.submissionColumns=[],s.field&&(e.submissionQuery["data."+s.field+"._id"]=i[r+"Id"]),e.$on("rowView",function(e,r){o.go(n+"form.submission.view",{formId:r.form,submissionId:r._id})}),e.currentForm.promise.then(function(r){m.eachComponent(r.components,function(r){r.key&&r.input&&r.tableView&&(s.field&&r.key===s.field||e.submissionColumns.push(r.key))}),e.$broadcast("reloadGrid")}),t.submissions&&u(t.submissions,{$scope:e})}]}).state(n+"form.submission",{"abstract":!0,url:"/submission/:submissionId",params:s.params&&s.params.submission,templateUrl:i.submission?i.submission:"formio-helper/submission/submission.html",controller:["$scope","$stateParams","Formio","$controller",function(e,r,o,s){e.currentSubmission={url:e.currentForm.url+"/submission/"+r.submissionId,submission:{}},e.currentSubmission.formio=new o(e.currentSubmission.url),e.currentSubmission.promise=e.currentSubmission.formio.loadSubmission().then(function(r){return e.currentSubmission.submission=r,r}),t.submission&&s(t.submission,{$scope:e})}]}).state(n+"form.submission.view",{url:"/",params:s.params&&s.params.submissionView,templateUrl:i.submissionView?i.submissionView:"formio-helper/submission/view.html",controller:["$scope","$controller",function(e,r){t.submissionView&&r(t.submissionView,{$scope:e})}]}).state(n+"form.submission.edit",{url:"/edit",params:s.params&&s.params.submissionEdit,templateUrl:i.submissionEdit?i.submissionEdit:"formio-helper/submission/edit.html",controller:["$scope","$state","$controller",function(e,r,o){e.$on("formSubmission",function(o,s){e.currentSubmission.submission=s,r.go(n+"form.submission.view")}),t.submissionEdit&&o(t.submissionEdit,{$scope:e})}]}).state(n+"form.submission.delete",{url:"/delete",params:s.params&&s.params.submissionDelete,templateUrl:i.submissionDelete?i.submissionDelete:"formio-helper/submission/delete.html",controller:["$scope","$state","$controller",function(e,r,o){e.$on("delete",function(){r.go(n+"form.submissions")}),e.$on("cancel",function(){r.go(n+"form.submission.view")}),t.submissionDelete&&o(t.submissionDelete,{$scope:e})}]})},$get:function(){return r}}}]).provider("FormioAuth",["$stateProvider",function(e){var r="auth.login",o="home",s=!1;return e.state("auth",{"abstract":!0,url:"/auth",templateUrl:"views/user/auth.html"}),{setForceAuth:function(e){s=e},setStates:function(e,s){r=e,o=s},register:function(r,s,i){i||(i=r),e.state("auth."+r,{url:"/"+i,parent:"auth",templateUrl:"views/user/"+r.toLowerCase()+".html",controller:["$scope","$state","$rootScope",function(e,r,i){e.$on("formSubmission",function(e,t){t&&(i.setUser(t,s),r.go(o))})}]})},$get:["Formio","FormioAlerts","$rootScope","$state",function(e,o,i,t){return{init:function(){i.user={},i.isRole=function(e){return i.role===e.toLowerCase()},i.setUser=function(r,o){r?(i.user=r,localStorage.setItem("formioAppUser",angular.toJson(r))):(i.user=null,localStorage.removeItem("formioAppUser"),localStorage.removeItem("formioUser"),localStorage.removeItem("formioToken")),o?(i.role=o.toLowerCase(),localStorage.setItem("formioAppRole",o)):(i.role=null,localStorage.removeItem("formioAppRole")),i.authenticated=!!e.getToken()};var n=localStorage.getItem("formioAppUser");i.setUser(n?angular.fromJson(n):null,localStorage.getItem("formioAppRole")),i.user||e.currentUser().then(function(e){i.setUser(e,localStorage.getItem("formioRole"))});var m=function(){t.go(r,{},{reload:!0}),o.addAlert({type:"danger",message:"Your session has expired. Please log in again."})};i.$on("formio.sessionExpired",m),i.logout=function(){i.setUser(null,null),e.logout().then(function(){t.go(r,{},{reload:!0})})["catch"](m)},i.$on("$stateChangeStart",function(o,n){if(i.authenticated=!!e.getToken(),s){if("auth"===n.name.substr(0,4))return;i.authenticated||(o.preventDefault(),t.go(r,{},{reload:!0}))}}),i.$on("$stateChangeSuccess",function(){i.alerts=o.getAlerts()})}}}]}}]).factory("FormioAlerts",["$rootScope",function(e){var r=[];return{addAlert:function(o){e.alerts.push(o),o.element?angular.element("#form-group-"+o.element).addClass("has-error"):r.push(o)},getAlerts:function(){var e=angular.copy(r);return r.length=0,r=[],e},onError:function o(e){if(e.message)this.addAlert({type:"danger",message:e.message,element:e.path});else{var r=e.hasOwnProperty("errors")?e.errors:e.data.errors;angular.forEach(r,o.bind(this))}}}}]).run(["$templateCache","$rootScope","$state",function(e,r,o){r.isActive=function(e){return-1!==o.current.name.indexOf(e)},e.put("formio-helper/resource/resource.html",'<h2>{{ currentResource.name | capitalize }}</h2>\n<ul class="nav nav-tabs">\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.view\')}"><a ui-sref="{{ currentResource.name }}.view()">View</a></li>\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.edit\')}"><a ui-sref="{{ currentResource.name }}.edit()">Edit</a></li>\n  <li role="presentation" ng-class="{active:isActive(currentResource.name + \'.delete\')}"><a ui-sref="{{ currentResource.name }}.delete()">Delete</a></li>\n</ul>\n<div ui-view></div>\n'),e.put("formio-helper/resource/create.html",'<h3>New {{ currentResource.name | capitalize }}</h3>\n<hr></hr>\n<formio src="currentResource.formUrl" submission="submission"></formio>\n'),e.put("formio-helper/resource/delete.html",'<formio-delete src="currentResource.submissionUrl" resource-name="resourceName"></formio-delete>\n'),e.put("formio-helper/resource/edit.html",'<formio src="currentResource.submissionUrl"></formio>\n'),e.put("formio-helper/resource/index.html",'<formio-submissions src="currentResource.formUrl"></formio-submissions>\n<a ui-sref="{{ currentResource.name }}Create()" class="btn btn-primary"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span> New {{ currentResource.name | capitalize }}</a>\n'),e.put("formio-helper/resource/view.html",'<formio src="currentResource.submissionUrl" read-only="true"></formio>\n'),e.put("formio-helper/form/list.html",'<ul class="list-group">\n    <li class="list-group-item" ng-repeat="form in forms"><a ui-sref="{{ base }}form.view({formId: form._id})">{{ form.title }}</a></li>\n</ul>'),e.put("formio-helper/form/index.html",'<formio-forms src="formsSrc" tag="formsTag" base="formBase"></formio-forms>'),e.put("formio-helper/form/form.html",'<ul class="nav nav-tabs">\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.view\')}"><a ui-sref="{{ formBase }}form.view()">Form</a></li>\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.submissions\')}"><a ui-sref="{{ formBase }}form.submissions()">Submissions</a></li>\n</ul>\n<div ui-view style="margin-top:20px;"></div>'),e.put("formio-helper/form/view.html",'<formio form="currentForm.form" form-action="currentForm.url + \'/submission\'" submission="submission"></formio>'),e.put("formio-helper/submission/index.html",'<formio-grid src="currentForm.url" query="submissionQuery" columns="submissionColumns"></formio-grid>'),e.put("formio-helper/submission/submission.html",'<ul class="nav nav-pills">\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.view\')}"><a ui-sref="{{ formBase }}form.submission.view()">View</a></li>\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.edit\')}"><a ui-sref="{{ formBase }}form.submission.edit()">Edit</a></li>\n    <li role="presentation" ng-class="{active:isActive(formBase + \'form.submission.delete\')}"><a ui-sref="{{ formBase }}form.submission.delete()">Delete</a></li>\n</ul>\n<div ui-view style="margin-top:20px;"></div>'),e.put("formio-helper/submission/view.html",'<formio form="currentForm.form" submission="currentSubmission.submission" read-only="true"></formio>'),e.put("formio-helper/submission/edit.html",'<formio form="currentForm.form" submission="currentSubmission.submission" form-action="currentSubmission.url"></formio>'),e.put("formio-helper/submission/delete.html",'<formio-delete src="currentSubmission.url"></formio-delete>')}])},{}]},{},[1]);